# Пульт охраны банка

Программа подключается к базе данных, фиксирует все посещения хранилища и выводит данные на сайте, что помогает следить за всеми, кто находится в этом хранилище.

Все файлы взяты из учебного курса "devman", некоторый скрипт дописан в:

## datacenter/models.py

Внутри модели Passcard описаны пропуска с полями:
* is_active - активна ли карта пропуска,
* created_at - дата выдачи пропуска,
* passcode - уникальный код пропуска,
* owner_name - имя и фамилия держателя пропуска.

Внутри модели Visit описаны посещения хранилища с полями:
* created_at - [TODO: это поле не используется, что в нем лежит не знаю],
* passcard - пропуск для посещения,
* entered_at - дата и время входа в хранилище,
* leaved_at - дата и время выхода из хранилища.
  
Здесь же описаны методы:

### get_duration

Метод рассчитывает длительность визита в секундах. Если работних до сих пор находится внутри хранилища, то время рассчитывается по сей момент.

### format_duration

Метод превращает длительность визита в строку формата "hh:mm".

### is_long

Метод определяет, подозрителен визит или нет. Возвращает True или False.

## datacenter/active_passcards_view.py

На вход получет запрос от браузера. Скрипт получет список активных пропусков из БД и возвращает пользователю эти данные подставленные в шаблон.

## datacenter/storage_information_view.py

На вход получет запрос от браузера. Скрипт получет список из БД тех, кто зашел в хранилище и не вышел, затем для каждого такого работника считает время, проведенное внутри:
```python
for visit in visits:
  duration = visit.get_duration()
  ...
```
и возвращает пользователю имя работника, время входа в хранилищие, проведенное внутри время и подозрительность пребывания подставленные в шаблон.

## datacenter/passcard_info_view.py

На вход получет запрос от браузера и уникальный код пропуска. Скрипт получет по коду сам пропуск или выдает ошибку "404" в случае отсутствия пропуска:
```python
passcard = get_object_or_404(Passcard, passcode=passcode)
```
затем собирает в список все визиты в хранилище по данному пропуску, и возвращает пользователю время входа в хранилище, проведенное внутри время и подозрительность пребывания подставленные в шаблон.
